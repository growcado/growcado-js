{"version":3,"file":"auth-utils.js","names":["_minimatch","require","createSessionToken","tenHoursTime","expires","Date","now","getAuthenticatedMessage","user","buildUserBuffer","name","password","Buffer","from","buildToken","type","token","capitalize","getMatchedPackagesSpec","pkgName","packages","i","minimatch","makeRe","exec","str","charAt","toUpperCase","slice","toLowerCase"],"sources":["../src/auth-utils.ts"],"sourcesContent":["import { MMRegExp, minimatch } from 'minimatch';\n\nimport { PackageAccess, PackageList } from '@verdaccio/types';\n\nexport interface CookieSessionToken {\n  expires: Date;\n}\n\nexport function createSessionToken(): CookieSessionToken {\n  const tenHoursTime = 10 * 60 * 60 * 1000;\n\n  return {\n    // npmjs.org sets 10h expire\n    expires: new Date(Date.now() + tenHoursTime),\n  };\n}\n\nexport function getAuthenticatedMessage(user: string): string {\n  return `you are authenticated as '${user}'`;\n}\n\nexport function buildUserBuffer(name: string, password: string): Buffer {\n  return Buffer.from(`${name}:${password}`, 'utf8');\n}\n\nexport function buildToken(type: string, token: string): string {\n  return `${capitalize(type)} ${token}`;\n}\n\nexport function getMatchedPackagesSpec(\n  pkgName: string,\n  packages: PackageList\n): PackageAccess | void {\n  for (const i in packages) {\n    if ((minimatch.makeRe(i) as MMRegExp).exec(pkgName)) {\n      return packages[i];\n    }\n  }\n  return;\n}\n\nfunction capitalize(str: string): string {\n  return str.charAt(0).toUpperCase() + str.slice(1).toLowerCase();\n}\n"],"mappings":";;;;;;;;;;AAAA,IAAAA,UAAA,GAAAC,OAAA;AAQO,SAASC,kBAAkBA,CAAA,EAAuB;EACvD,MAAMC,YAAY,GAAG,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG,IAAI;EAExC,OAAO;IACL;IACAC,OAAO,EAAE,IAAIC,IAAI,CAACA,IAAI,CAACC,GAAG,CAAC,CAAC,GAAGH,YAAY;EAC7C,CAAC;AACH;AAEO,SAASI,uBAAuBA,CAACC,IAAY,EAAU;EAC5D,OAAO,6BAA6BA,IAAI,GAAG;AAC7C;AAEO,SAASC,eAAeA,CAACC,IAAY,EAAEC,QAAgB,EAAU;EACtE,OAAOC,MAAM,CAACC,IAAI,CAAC,GAAGH,IAAI,IAAIC,QAAQ,EAAE,EAAE,MAAM,CAAC;AACnD;AAEO,SAASG,UAAUA,CAACC,IAAY,EAAEC,KAAa,EAAU;EAC9D,OAAO,GAAGC,UAAU,CAACF,IAAI,CAAC,IAAIC,KAAK,EAAE;AACvC;AAEO,SAASE,sBAAsBA,CACpCC,OAAe,EACfC,QAAqB,EACC;EACtB,KAAK,MAAMC,CAAC,IAAID,QAAQ,EAAE;IACxB,IAAKE,oBAAS,CAACC,MAAM,CAACF,CAAC,CAAC,CAAcG,IAAI,CAACL,OAAO,CAAC,EAAE;MACnD,OAAOC,QAAQ,CAACC,CAAC,CAAC;IACpB;EACF;EACA;AACF;AAEA,SAASJ,UAAUA,CAACQ,GAAW,EAAU;EACvC,OAAOA,GAAG,CAACC,MAAM,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC,GAAGF,GAAG,CAACG,KAAK,CAAC,CAAC,CAAC,CAACC,WAAW,CAAC,CAAC;AACjE","ignoreList":[]}