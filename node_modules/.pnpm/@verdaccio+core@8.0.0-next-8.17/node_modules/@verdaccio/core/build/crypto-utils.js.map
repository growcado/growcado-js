{"version":3,"file":"crypto-utils.js","names":["_nodeCrypto","require","defaultTarballHashAlgorithm","exports","createTarballHash","createHash","stringToMD5","data","update","digest","generateRandomHexString","length","pseudoRandomBytes","toString","mask","str","charNum","slice"],"sources":["../src/crypto-utils.ts"],"sourcesContent":["import { Hash, createHash, pseudoRandomBytes } from 'node:crypto';\n\nexport const defaultTarballHashAlgorithm = 'sha1';\n\nexport function createTarballHash(): Hash {\n  return createHash(defaultTarballHashAlgorithm);\n}\n\n/**\n * Express doesn't do ETAGS with requests <= 1024b\n * we use md5 here, it works well on 1k+ bytes, but sucks with fewer data\n * could improve performance using crc32 after benchmarks.\n * @param {Object} data\n * @return {String}\n */\nexport function stringToMD5(data: Buffer | string): string {\n  // @ts-ignore update method accepts Buffer or string\n  return createHash('md5').update(data).digest('hex');\n}\n\nexport function generateRandomHexString(length = 8): string {\n  return pseudoRandomBytes(length).toString('hex');\n}\n\n/**\n * return a masquerade string with its first and last {charNum} and three dots in between.\n * @param {String} str\n * @param {Number} charNum\n * @returns {String}\n */\nexport function mask(str: string, charNum = 3): string {\n  return `${str.slice(0, charNum)}...${str.slice(-charNum)}`;\n}\n"],"mappings":";;;;;;;;;;AAAA,IAAAA,WAAA,GAAAC,OAAA;AAEO,MAAMC,2BAA2B,GAAAC,OAAA,CAAAD,2BAAA,GAAG,MAAM;AAE1C,SAASE,iBAAiBA,CAAA,EAAS;EACxC,OAAO,IAAAC,sBAAU,EAACH,2BAA2B,CAAC;AAChD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACO,SAASI,WAAWA,CAACC,IAAqB,EAAU;EACzD;EACA,OAAO,IAAAF,sBAAU,EAAC,KAAK,CAAC,CAACG,MAAM,CAACD,IAAI,CAAC,CAACE,MAAM,CAAC,KAAK,CAAC;AACrD;AAEO,SAASC,uBAAuBA,CAACC,MAAM,GAAG,CAAC,EAAU;EAC1D,OAAO,IAAAC,6BAAiB,EAACD,MAAM,CAAC,CAACE,QAAQ,CAAC,KAAK,CAAC;AAClD;;AAEA;AACA;AACA;AACA;AACA;AACA;AACO,SAASC,IAAIA,CAACC,GAAW,EAAEC,OAAO,GAAG,CAAC,EAAU;EACrD,OAAO,GAAGD,GAAG,CAACE,KAAK,CAAC,CAAC,EAAED,OAAO,CAAC,MAAMD,GAAG,CAACE,KAAK,CAAC,CAACD,OAAO,CAAC,EAAE;AAC5D","ignoreList":[]}